### BusinessException
```
package com.sangfor.platform.exception;
/**
 * 业务异常
 * @author wudu.yu
 */
public class BusinessException extends RuntimeException{
    private static final long serialVersionUID = 2074707635527872856L;

    /**
     * 错误代码
     */
    private final IErrorCode code;

    /**
     * 变量参数
     */
    private final Object[] params;

    public BusinessException(IErrorCode errorCode, Object... params) {
        super(errorCode.getMessageWithCode(params));
        this.code = errorCode;
        this.params = params;
    }

    public BusinessException(Throwable cause, IErrorCode errorCode, Object... params) {
        super(errorCode.getMessageWithCode(params), cause);
        this.code = errorCode;
        this.params = params;
    }

    public String getCode() { return this.code.getCode(); }

    public Object[] getParams() { return this.params; }

    @Override
    public String getMessage() { return this.code.getMessage(this.params); }

    public String getDefinitionMessage() {return this.code.getMessage();}

    public boolean hasCause() { return this.getCause() != null; }
}

```

### ServiceException
```
package com.sangfor.platform.exception.service;

import com.sangfor.platform.exception.BusinessException;
import com.sangfor.platform.exception.IErrorCode;

/**
 * service处理异常
 */
public class ServiceException extends BusinessException {

    private static final long serialVersionUID = -2437160791033393978L;

    private final Object data;

    public ServiceException(IErrorCode errorCode, Object... params) {
        super(errorCode, params);
        this.data = null;
    }

    public ServiceException(Throwable cause, IErrorCode errorCode, Object... params) {
        super(cause, errorCode, params);
        this.data = null;
    }

    public ServiceException(Object data, IErrorCode errorCode, Object... params) {
        super(errorCode, params);
        this.data = data;
    }

    public ServiceException(Object data, IErrorCode errorCode) {
        super(errorCode);
        this.data = data;
    }

    @SuppressWarnings("unchecked")
    public <T> T getData() {
        return (T) this.data;
    }

}

```

### ControllerException
```
package com.sangfor.platform.exception.controller;


import com.sangfor.platform.exception.BusinessException;
import com.sangfor.platform.exception.IErrorCode;

/**
 * 控制器异常
 */
public class ControllerException extends BusinessException {

	private static final long serialVersionUID = 1412104290896291466L;

	public ControllerException(IErrorCode errorCode, Object... params) {
		super(errorCode, params);
	}

	public ControllerException(Throwable cause, IErrorCode errorCode, Object... params) {
		super(cause, errorCode, params);
	}

}

```

### IErrorCode
```
public interface IErrorCode {

    /**
     * 获取错误码
     * @return
     */
    String getCode();

    /**
     * 获取错误提示
     * @param params
     * @return
     */
    String getMessageWithCode(Object... params);

    String getMessage(Object... params);
}
```

### ErrorCode
```
package com.sangfor.platform.exception;

import com.sangfor.platform.enums.SystemErrorCodeEnum;

import java.text.MessageFormat;

/**
 *
 * @author 余亮
 */
public class ErrorCode implements IErrorCode{

    /**
     * 错误码长度（6位）
     */
//    public static final int ERROR_CODE_LENGTH = 6;

    private static final Object[] ARRAY_OF_SINGLE_NULL = new Object[]{null};

    /**
     * 错误码
     */
    private final String code;

    private final String message;

    /**
     * 是否需要替换参数
     */
    private final boolean doReplace;

    public ErrorCode(String code, String message) {
        if (null == code || code.trim().isEmpty()) {
            throw new BusinessException(SystemErrorCodeEnum.CODE_EMPTY);
        }

//        if (ERROR_CODE_LENGTH != code.length()) {
//            throw new BusinessException(SystemErrorCodeEnum.CODE_ERROR, code);
//        }

        if (null == message) {
            message = "";
        } else {
            message = message.trim();
        }

        boolean doReplace = false;

        try {
            MessageFormat mf = new MessageFormat(message);
            doReplace = mf.getFormats().length > 0;
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        }
        this.code = code;
        this.message = message;
        this.doReplace = doReplace;
    }

    @Override
    public String getCode() {
        return this.code;
    }

    @Override
    public String getMessageWithCode(Object... params) {
        String msg = _getMessage(params);
        if (!msg.startsWith(code)) {
            msg = this.code + " - " + msg;
        }
        return msg;
    }

    @Override
    public String getMessage(Object... params) {
        String msg = _getMessage(params);
        return msg;
    }


    String _getMessage(Object... params) {

        if (message.isEmpty()) {
            String message = this.code + " - UNKONWN ERROR";

            if (null == params || 0 == params.length) {
                return message;
            }

            StringBuilder sb = new StringBuilder(message);
            sb.append("(");
            for (int i = 0; i < params.length; i++) {
                Object param = params[i];
                if (i > 0) {
                    sb.append(", ");
                }
                sb.append(param.toString());
            }
            sb.append(")");

            return sb.toString();
        }

        if (!doReplace) {
            return message;
        }

        Object[] _params = params;

        if (_params == null) {
            _params = ARRAY_OF_SINGLE_NULL;
        }

        String _message = message;

        if (_params.length > 0) {
            try {
                _message = MessageFormat.format(_message, _params);
            } catch (Exception e) {

            }
        }

        return _message;
    }

}

```

### CommonErrorCodeEnum
```
package com.sangfor.platform.enums;

import com.sangfor.platform.exception.ErrorCode;
import com.sangfor.platform.exception.IErrorCode;

/**
 * 通用错误码
 *
 * @author 余亮
 */
public enum CommonErrorCodeEnum implements IErrorCode {

    /**
     *
     */
    COMMON_NOT_EMPTY("0x030050020001", "system.exception.common_not_empty"),
    COMMON_OUTSIDE_ERROR("0x030050020002", "system.exception.common_outside_error"),
    COMMON_FAIL("0x030050020003", "system.exception.common_fail"),
    COMMON_NOT_EXIST("0x030050020004", "system.exception.common_not_exist"),
    COMMON_MESSAGE("0x030050020005", "system.exception.common_message"),
    NO_DATA_PERMISSION("0x0300100A0005", "system.exception.no_data_permission");

    private final ErrorCode errorCode;

    CommonErrorCodeEnum(String code, String message) {
        this.errorCode = new ErrorCode(code, message);
    }

    @Override
    public String getCode() {
        return errorCode.getCode();
    }

    @Override
    public String getMessage(Object... params) {
        return errorCode.getMessage(params);
    }

    @Override
    public String getMessageWithCode(Object... params) {
        return errorCode.getMessageWithCode(params);
    }
}

```

### SystemErrorCodeEnum
```
package com.sangfor.platform.enums;
import com.sangfor.platform.exception.ErrorCode;
import com.sangfor.platform.exception.IErrorCode;

/**
 * 系统错误码
 * @author余亮
 */
public enum SystemErrorCodeEnum implements IErrorCode {
    /**
     * 系统错误码信息
     */
    UNSUPPORT_REQUEST_TYPE("0x030050010001", "system.exception.unsupport_request_type"),
    CODE_EMPTY("0x030050010002", "system.exception.code_empty"),
    VALIDATION_ERROR("0x030050010003", "system.exception.validation_error"),
    ILLEGAL_ARGUMENT("0x030050010004", "system.exception.illegal_argument"),
    JSON_PARSE_EXCEPTION("0x030050010005", "system.exception.json_parse_exception"),
    INTERNAL_SERVER_ERROR("0x030050010006", "system.exception.internal_server_error"),
    COMMON_SERVER_ERROR("0x030050010006", "system.exception.common_server_error"),
    DATA_PARSE_ERROR("0x030050010007", "system.exception.data_parse_error"),
    INVALID_CSRF_TOKEN("0x030050010008", "Invalid CSRF token found for {0}"),
    ACMPAUTHTOKEN_NOT_FOUND("0x030050010009", "aCMPAuthToken not found"),
    PATH_NOT_EXISTS("0x03005001000A", "system.exception.path_not_exists"),
    FILE_SIZE_EXCEEDED("0x03005001000B", "system.exception.file_size_exceeded")
    ;

    private final ErrorCode errorCode;

    SystemErrorCodeEnum(String code, String message) {
        this.errorCode = new ErrorCode(code, message);
    }

    @Override
    public String getCode() {
        return errorCode.getCode();
    }

    @Override
    public String getMessage(Object... params) {
        return errorCode.getMessage(params);
    }

    @Override
    public String getMessageWithCode(Object... params) {
        return errorCode.getMessageWithCode(params);
    }
}

```

